import string 
from sage.all import * 
from hashlib import sha256 
from Crypto.Util.number import getPrime, bytes_to_long as btl 

FLAG = b'HCMUS-CTF{surely_this_is_the_real_flag_xdd_136825d2dc8a9658e}'

assert len(FLAG) == 61 
assert sha256(FLAG).hexdigest() == '136825d2dc8a9658e7e41d9c9a9180dc7eeed802b7801b9836f9d012c4986f7e'
assert all(x in (string.ascii_letters + string.digits + '_').encode() for x in FLAG.lstrip(b'HCMUS-CTF{')[:-1])

p = getPrime(1024)
q = getPrime(1024)
n = p * q 

M = Matrix(Zmod(n), [
            [btl(FLAG[:len(FLAG) // 4]), btl(FLAG[len(FLAG) // 4:2 * len(FLAG) // 4]) ], 
            [btl(FLAG[2 * len(FLAG) // 4:3*len(FLAG) // 4]), btl(FLAG[3 * len(FLAG) // 4:])]
])

print((M ** 137).list())
print(n)

"""
[21691927251298929574793825306968016589257841225744612438423411215871165646889186462884633499063891051733420806390784031095460091469991428718350251573321638295357625280732280593843321528388451128602684914003730212825566839057512445957523108352367932201951432440517157663797577212946333582939825843144416793673765919935106455638252513969322964512561223861444520929752491522444909776146500037192984617951684282022520224730903818056019676687161680013856738845814158697467948608406745678007353530712172857893360583613698033571302084094347057950024055173717187891255625865344720786162209176050577503621365452892834420482908, 6775015723588315442468013512366044529203222324650057249198735182527431906625354699216017571632277514906216192204437896815288717630950674265558424471579379934261423061387690255300260915057506287349048614000887400326223969023178005290868233394083126712565683737745698252044455951302156926397914219914629773129997899933346670129176219768593260204565242334697524816186643881306468644681875796325980429428748192603915351721265884788478910502192297683039229161507825951980045773589725271199703030268482407708055479434365543441701786970145392381298209766221091865685099163626982227803527124755996798268608818870793594147463, 19805656005683658088873291548104636829896196804201194286261683596366778438725959990000732010758375657690753180596775446887564516516909603640218121703989042253523187779793305274238741953719546377699482277144548994955238482135168697081886010518739421565521367608672254275497616500444993069458819293137942208071627825314151913470951554918363167499197056868822062723311411308155719117741019977387785310172531069324042481497564543880315337050521854428532524560247627949955910071265403086111368699033743057797036542497121498615036564603164280016966031115644726121020982108592073948041869016853349011278093919710667051089318, 90057784737567099569529004721054195422075038346716868764515725103847290560159775589118270286213652023938335145170927378320250428104004230258644097014560007618586427760876948311797749136816123170683841596904885703917965933140769345385422632123065342400692218248134805488539964431784875146018668950292820287032769854276884856308189776463202644051774646050883632207691439314431734832319558731246366312497574465686061918031452930757895060497147115832115819175061314474533963562310995894644918305373891344087969645069212026461007044921987784822880756692119292001292085343438286670425046876954849365019538810083883391619]
25093610144908461464059057408568647065852509496910506454219029231729615790182838521750666866220278951668213036781863233070073888264737231955166698931256387186706709967683366405223674886514417461424423811600936935913459851157466271803054923435838872834203098196847763934619584820142686420544929795531754633813915442819237995875546815902669291787704729075851900787370032144290248373787526232788049121242923165373815660903262194195632414516883985594279799045995517317604084920418118272895521418338434234634526455272161460427621237242918538081864414570820209101902145835308168984602150410855452852774414322666120594785481
"""